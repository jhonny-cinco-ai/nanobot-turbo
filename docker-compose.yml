version: "3.8"

services:
  nanofolks:
    build:
      context: .
      dockerfile: Dockerfile
    image: nanofolks:latest
    container_name: nanofolks
    volumes:
      - ~/.nanofolks:/root/.nanofolks
      - ./workspace:/workspace
    environment:
      - NANOFOLKS_CONFIG_DIR=/root/.nanofolks
    ports:
      - "18790:18790"
      - "18791-18800:18791-18800" # Dashboard port range
    restart: unless-stopped
    stdin_open: true
    tty: true

  whatsapp-bridge:
    image: nanofolks:latest
    container_name: nanofolks-bridge
    depends_on:
      - nanofolks
    volumes:
      - ~/.nanofolks:/root/.nanofolks
    environment:
      - NANOFOLKS_CONFIG_DIR=/root/.nanofolks
    command: [ "bridge" ]
    ports:
      - "18791:18791"
    restart: unless-stopped
